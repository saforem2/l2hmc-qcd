%\begin{document}
\section{Tunneling Rates}%
\label{sec:tunneling_rates}
% \subsection{Tunneling Rates}%
% \label{subsec:tunneling_rates}
%
For inference, we generate \(M\times N\) configurations (batch of \(M\) chains in
parallel, for \(N\) MH-Accept/Rejects), and drop the first \(25\%\)
percent of the data before computing observables to account for
burn-in\footnote{For computing statistics of observables, we use bootstrap
resampling.}.
%
We compute the topological charge, \(\mathcal{Q} =
\frac{1}{2\pi}\sum_{x}\mathrm{Arg}\left(\phi_{\mu\nu}(x)\right) \in
\mathbb{Z}\), with \( \mathrm{Arg}\left(\phi_{\mu\nu}(x)\right) \in \left[-\pi,
\pi\right]\) for each configuration.
%

For the \(m^{\mathrm{th}}\) chain in our batch, we define 
%
\begin{align}
  \delta\mathcal{Q}_{m}(n) &\coloneqq \mathcal{Q}{(n+1)} - \mathcal{Q}{(n)}\\
  \langle\delta\mathcal{Q}_{m}\rangle &\coloneqq
  \frac{1}{N}\sum_{n=0}\delta\mathcal{Q}_{m}(n).
\end{align}
%
We can then compute the average tunneling rate over all chains (i.e.\@ the
number of tunneling events per step) as
%
\begin{equation}
  \langle \delta\mathcal{Q}\rangle%
  \coloneqq \frac{1}{M}\sum_{m=1}^{M}\langle\delta\mathcal{Q}_{m}\rangle
  =\frac{1}{M}\sum_{m=1}^{M}\left[\frac{1}{N}\sum_{n=0}^{N} \delta\mathcal{Q}_{m}(n)\right]
\end{equation}
%

\begin{figure}[htpb]
  \centering
  \includegraphics[width=\textwidth]{tunneling_rates/dq_lf10}
  \caption{Comparison of the tunneling rates,
  \(\langle\delta\mathcal{Q}\rangle\) for HMC and L2HMC}
\end{figure}

% \begin{figure}[htpb]
%   \centering
%   \begin{subfigure}{0.48\textwidth}
%     % \input{/Users/saforem2/l2hmc-qcd/doc/figures/updates_2020_10_13/dq_lf10_beta2.tex}
%     \includegraphics[width=\textwidth]{updates_2020_10_13/dq_lf10_beta2.pdf}
%   \end{subfigure}
%   \begin{subfigure}{0.48\textwidth}
%     % \input{/Users/saforem2/l2hmc-qcd/doc/figures/updates_2020_10_13/dq_lf10_beta3.tex}
%     % \input{../figures/updates_2020_10_13/dq_lf10_beta3.tex}
%     \includegraphics[width=\textwidth]{updates_2020_10_13/dq_lf10_beta3.pdf}
%   \end{subfigure}
%   \begin{subfigure}{0.48\textwidth}
%     % \input{/Users/saforem2/l2hmc-qcd/doc/figures/updates_2020_10_13/dq_lf10_beta3.tex}
%     % \input{../figures/updates_2020_10_13/dq_lf10_beta4.tex}
%     \includegraphics[width=\textwidth]{updates_2020_10_13/dq_lf10_beta4.pdf}
%   \end{subfigure}
%   \begin{subfigure}{0.48\textwidth}
%     % \input{/Users/saforem2/l2hmc-qcd/doc/figures/updates_2020_10_13/dq_lf10_beta5.tex}
%     % \input{../figures/updates_2020_10_13/dq_lf10_beta5.tex}
%     \includegraphics[width=\textwidth]{updates_2020_10_13/dq_lf10_beta5.pdf}
%   \end{subfigure}
%   % \includegraphics[width=\textwidth]{updates_2020_10_13/tunneling_rates_lf10_row1.pdf}
%   \caption{Comparison of the tunneling rates,
%   \(\langle\delta\mathcal{Q}\rangle\) for HMC and L2HMC}
% \end{figure}

% \input{/Users/saforem2/l2hmc-qcd/logs/tunneling_rates/2020-10-16/figs/dq_lf10_stats_beta_2020-10-16-141354_tikz.tex}
%\end{document}
